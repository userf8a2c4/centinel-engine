# Defensive Dead Man's Switch config / Configuraci√≥n del interruptor defensivo.
cpu_threshold_percent: 90
cpu_sustain_seconds: 60
memory_threshold_percent: 85
http_errors_limit: 10
http_window_seconds: 300
error_log_flood_limit: 50
error_log_window_seconds: 60
monitor_connections: true
expected_ports: [443, 8080, 8081]
suspicious_connections_limit: 3

safe_state_dir: data/safe_state
defensive_flag_file: data/safe_state/defensive_shutdown.flag

max_restart_attempts: 5
cooldown_min_minutes: 10
cooldown_max_minutes: 60

admin_email: example@domain.com
alert_email: admin@example.com
webhook_url: ""
smtp_settings:
  server: smtp.example.com
  port: 587
  user: ""
  password: ""

alerts:
  enabled: true
  escalation_failures: 3
  channels: ["email", "telegram", "sms_webhook"]

honeypot:
  enabled: true
  host: 127.0.0.1
  port: 8081
  honeypot_threshold: 100

observability:
  prometheus_port: 8000

forensics:
  log_rotation_days: 7
